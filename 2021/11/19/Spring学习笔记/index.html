<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"rosinanteplusssss.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.21.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="尚硅谷spring视频学习笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="Spring学习笔记">
<meta property="og:url" content="https://rosinanteplusssss.github.io/2021/11/19/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="日復一日">
<meta property="og:description" content="尚硅谷spring视频学习笔记">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img-blog.csdnimg.cn/2021030219074044.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1ODQzNTE0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20210306191809640.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1ODQzNTE0,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20210306191909673.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1ODQzNTE0,size_16,color_FFFFFF,t_70">
<meta property="article:published_time" content="2021-11-19T06:20:45.000Z">
<meta property="article:modified_time" content="2021-11-19T06:34:23.548Z">
<meta property="article:author" content="Yellow">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="Spring">
<meta property="article:tag" content="笔记">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/2021030219074044.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1ODQzNTE0,size_16,color_FFFFFF,t_70">


<link rel="canonical" href="https://rosinanteplusssss.github.io/2021/11/19/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://rosinanteplusssss.github.io/2021/11/19/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","path":"2021/11/19/Spring学习笔记/","title":"Spring学习笔记"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Spring学习笔记 | 日復一日</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">日復一日</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">當一個堅持的人</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#IOC%E6%A6%82%E5%BF%B5%E5%92%8C%E5%8E%9F%E7%90%86"><span class="nav-number">1.</span> <span class="nav-text">IOC概念和原理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFIOC"><span class="nav-number">1.1.</span> <span class="nav-text">什么是IOC</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IOC%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86"><span class="nav-number">1.2.</span> <span class="nav-text">IOC底层原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IOC%E8%BF%87%E7%A8%8B"><span class="nav-number">1.3.</span> <span class="nav-text">IOC过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IOC%E6%8E%A5%E5%8F%A3"><span class="nav-number">1.4.</span> <span class="nav-text">IOC接口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IOC%E6%93%8D%E4%BD%9CBean%E7%AE%A1%E7%90%86"><span class="nav-number">1.5.</span> <span class="nav-text">IOC操作Bean管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFBean%E7%AE%A1%E7%90%86"><span class="nav-number">1.5.1.</span> <span class="nav-text">什么是Bean管理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bean%E7%AE%A1%E7%90%86%E6%93%8D%E4%BD%9C%E6%9C%89%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="nav-number">1.5.2.</span> <span class="nav-text">Bean管理操作有两种方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#IOC%E6%93%8D%E4%BD%9CBean%E7%AE%A1%E7%90%86%EF%BC%88%E5%9F%BA%E4%BA%8EXML%E6%96%B9%E5%BC%8F%EF%BC%89"><span class="nav-number">1.5.2.1.</span> <span class="nav-text">IOC操作Bean管理（基于XML方式）</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8EXML%E6%96%B9%E5%BC%8F%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1"><span class="nav-number">1.5.2.1.1.</span> <span class="nav-text">基于XML方式创建对象</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8EXML%E6%96%B9%E5%BC%8F%E6%B3%A8%E5%85%A5%E5%B1%9E%E6%80%A7"><span class="nav-number">1.5.2.1.2.</span> <span class="nav-text">基于XML方式注入属性</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8EXML%E6%B3%A8%E5%85%A5%E5%85%B6%E4%BB%96%E7%B1%BB%E5%9E%8B%E5%B1%9E%E6%80%A7"><span class="nav-number">1.5.2.1.3.</span> <span class="nav-text">基于XML注入其他类型属性</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#FactoryBean"><span class="nav-number">1.5.2.2.</span> <span class="nav-text">FactoryBean</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#bean%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="nav-number">1.5.2.3.</span> <span class="nav-text">bean作用域</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#bean%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-number">1.5.2.4.</span> <span class="nav-text">bean生命周期</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#XML%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D"><span class="nav-number">1.5.2.4.1.</span> <span class="nav-text">XML自动装配</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A4%96%E9%83%A8%E5%B1%9E%E6%80%A7%E6%96%87%E4%BB%B6"><span class="nav-number">1.5.2.4.2.</span> <span class="nav-text">外部属性文件</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3%E6%96%B9%E5%BC%8F"><span class="nav-number">1.5.2.5.</span> <span class="nav-text">基于注解方式</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3%E6%96%B9%E5%BC%8F%E5%AE%9E%E7%8E%B0%E5%AF%B9%E8%B1%A1%E5%88%9B%E5%BB%BA"><span class="nav-number">1.5.2.5.1.</span> <span class="nav-text">基于注解方式实现对象创建</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BB%84%E4%BB%B6%E6%89%AB%E6%8F%8F%E7%BB%86%E8%8A%82"><span class="nav-number">1.5.2.5.2.</span> <span class="nav-text">组件扫描细节</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3%E6%96%B9%E5%BC%8F%E5%AE%9E%E7%8E%B0%E5%B1%9E%E6%80%A7%E6%B3%A8%E5%85%A5"><span class="nav-number">1.5.2.5.3.</span> <span class="nav-text">基于注解方式实现属性注入</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#Autowired%EF%BC%9A%E6%A0%B9%E6%8D%AE%E5%B1%9E%E6%80%A7%E7%B1%BB%E5%9E%8B%E8%BF%9B%E8%A1%8C%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D"><span class="nav-number">1.5.2.5.3.1.</span> <span class="nav-text">@Autowired：根据属性类型进行自动装配</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Qualifier%EF%BC%9A%E6%A0%B9%E6%8D%AE%E5%90%8D%E7%A7%B0%E8%BF%9B%E8%A1%8C%E6%B3%A8%E5%85%A5"><span class="nav-number">1.5.2.5.3.2.</span> <span class="nav-text">@Qualifier：根据名称进行注入</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Resource%EF%BC%9A%E5%8F%AF%E4%BB%A5%E6%A0%B9%E6%8D%AE%E7%B1%BB%E5%9E%8B%E6%B3%A8%E5%85%A5%EF%BC%8C%E5%8F%AF%E4%BB%A5%E6%A0%B9%E6%8D%AE%E5%90%8D%E7%A7%B0%E6%B3%A8%E5%85%A5"><span class="nav-number">1.5.2.5.3.3.</span> <span class="nav-text">@Resource：可以根据类型注入，可以根据名称注入</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%8C%E5%85%A8%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91"><span class="nav-number">1.5.2.5.4.</span> <span class="nav-text">完全注解开发</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#AOP"><span class="nav-number">2.</span> <span class="nav-text">AOP</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#AOP%E6%A6%82%E5%BF%B5"><span class="nav-number">2.1.</span> <span class="nav-text">AOP概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AOP%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86"><span class="nav-number">2.2.</span> <span class="nav-text">AOP底层原理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#AOP%E5%BA%95%E5%B1%82%E4%BD%BF%E7%94%A8%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86"><span class="nav-number">2.2.1.</span> <span class="nav-text">AOP底层使用动态代理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AOP%E7%9A%84JDK%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86"><span class="nav-number">2.3.</span> <span class="nav-text">AOP的JDK动态代理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%AF%E8%AF%AD"><span class="nav-number">2.4.</span> <span class="nav-text">术语</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9E%E6%8E%A5%E7%82%B9"><span class="nav-number">2.4.1.</span> <span class="nav-text">连接点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%87%E5%85%A5%E7%82%B9"><span class="nav-number">2.4.2.</span> <span class="nav-text">切入点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E7%9F%A5%EF%BC%88%E5%A2%9E%E5%BC%BA%EF%BC%89"><span class="nav-number">2.4.3.</span> <span class="nav-text">通知（增强）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%87%E9%9D%A2"><span class="nav-number">2.4.4.</span> <span class="nav-text">切面</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AOP%E6%93%8D%E4%BD%9C%E5%87%86%E5%A4%87"><span class="nav-number">2.5.</span> <span class="nav-text">AOP操作准备</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring%E6%A1%86%E6%9E%B6%E4%B8%80%E8%88%AC%E5%9F%BA%E4%BA%8EAspectJ%E5%AE%9E%E7%8E%B0AOP%E6%93%8D%E4%BD%9C"><span class="nav-number">2.5.1.</span> <span class="nav-text">Spring框架一般基于AspectJ实现AOP操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8EAspectJ%E5%AE%9E%E7%8E%B0AOP%E6%93%8D%E4%BD%9C"><span class="nav-number">2.5.2.</span> <span class="nav-text">基于AspectJ实现AOP操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%A8%E9%A1%B9%E7%9B%AE%E5%B7%A5%E7%A8%8B%E9%87%8C%E9%9D%A2%E5%BC%95%E5%85%A5AOP%E7%9B%B8%E5%85%B3%E4%BE%9D%E8%B5%96"><span class="nav-number">2.5.3.</span> <span class="nav-text">在项目工程里面引入AOP相关依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%87%E5%85%A5%E7%82%B9%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-number">2.5.4.</span> <span class="nav-text">切入点表达式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AOP%E6%93%8D%E4%BD%9C%EF%BC%88AspectJ%E6%B3%A8%E8%A7%A3%EF%BC%89"><span class="nav-number">2.6.</span> <span class="nav-text">AOP操作（AspectJ注解）</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1"><span class="nav-number">3.</span> <span class="nav-text">事务</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E4%BA%8B%E5%8A%A1"><span class="nav-number">3.1.</span> <span class="nav-text">什么是事务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E5%9B%9B%E4%B8%AA%E7%89%B9%E6%80%A7%EF%BC%88ACID-%EF%BC%89"><span class="nav-number">3.2.</span> <span class="nav-text">事务四个特性（ACID ）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E6%93%8D%E4%BD%9C%E8%BF%87%E7%A8%8B"><span class="nav-number">3.3.</span> <span class="nav-text">事务操作过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E6%93%8D%E4%BD%9C"><span class="nav-number">3.4.</span> <span class="nav-text">事务操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Sppring%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%E4%BB%8B%E7%BB%8D"><span class="nav-number">3.4.1.</span> <span class="nav-text">Sppring事务管理介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%A8%E8%A7%A3%E5%A3%B0%E6%98%8E%E5%BC%8F%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="nav-number">3.4.2.</span> <span class="nav-text">注解声明式事务管理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A3%B0%E6%98%8E%E5%BC%8F%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE"><span class="nav-number">3.4.3.</span> <span class="nav-text">声明式事务管理参数配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#propagation%EF%BC%9A%E4%BA%8B%E5%8A%A1%E4%BC%A0%E6%92%AD%E8%A1%8C%E4%B8%BA"><span class="nav-number">3.4.3.1.</span> <span class="nav-text">propagation：事务传播行为</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#REQUIRED%EF%BC%88%E9%BB%98%E8%AE%A4%E5%80%BC%EF%BC%89"><span class="nav-number">3.4.3.1.1.</span> <span class="nav-text">REQUIRED（默认值）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#REQUIRED-NEW"><span class="nav-number">3.4.3.1.2.</span> <span class="nav-text">REQUIRED_NEW</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#iosalton%EF%BC%9A%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="nav-number">3.4.3.2.</span> <span class="nav-text">iosalton：事务隔离级别</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#timeout%EF%BC%9A%E8%B6%85%E6%97%B6%E6%97%B6%E9%97%B4"><span class="nav-number">3.4.3.3.</span> <span class="nav-text">timeout：超时时间</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#readOnly%EF%BC%9A%E6%98%AF%E5%90%A6%E5%8F%AA%E8%AF%BB"><span class="nav-number">3.4.3.4.</span> <span class="nav-text">readOnly：是否只读</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#rollbackFor%EF%BC%9A%E5%9B%9E%E6%BB%9A"><span class="nav-number">3.4.3.5.</span> <span class="nav-text">rollbackFor：回滚</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#noRollbackFor%EF%BC%9A%E4%B8%8D%E5%9B%9E%E6%BB%9A"><span class="nav-number">3.4.3.6.</span> <span class="nav-text">noRollbackFor：不回滚</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#XML%E5%A3%B0%E6%98%8E%E5%BC%8F%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="nav-number">3.4.4.</span> <span class="nav-text">XML声明式事务管理（了解）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%8C%E5%85%A8%E6%B3%A8%E8%A7%A3%E5%A3%B0%E6%98%8E%E5%BC%8F%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="nav-number">3.4.5.</span> <span class="nav-text">完全注解声明式事务管理</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%97%AE%E9%A2%98%EF%BC%9A"><span class="nav-number">4.</span> <span class="nav-text">问题：</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Yellow"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Yellow</p>
  <div class="site-description" itemprop="description">碼農</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">48</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">31</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/rosinanteplusssss" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;rosinanteplusssss" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:yellowdingjr@gmail.com" title="E-Mail → mailto:yellowdingjr@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://rosinanteplusssss.github.io/2021/11/19/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Yellow">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="日復一日">
      <meta itemprop="description" content="碼農">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Spring学习笔记 | 日復一日">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Spring学习笔记
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-11-19 14:20:45 / 修改时间：14:34:23" itemprop="dateCreated datePublished" datetime="2021-11-19T14:20:45+08:00">2021-11-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Spring/" itemprop="url" rel="index"><span itemprop="name">Spring</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>4.6k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>15 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>尚硅谷spring视频学习笔记</p>
<span id="more"></span>

<h1 id="IOC概念和原理"><a href="#IOC概念和原理" class="headerlink" title="IOC概念和原理"></a>IOC概念和原理</h1><h2 id="什么是IOC"><a href="#什么是IOC" class="headerlink" title="什么是IOC"></a>什么是IOC</h2><ol>
<li>控制反转，把对象创建和对象之间的调用过程，交给Spring进行管理。</li>
<li>使用IOC目的：为了耦合度降低</li>
</ol>
<h2 id="IOC底层原理"><a href="#IOC底层原理" class="headerlink" title="IOC底层原理"></a>IOC底层原理</h2><p>XML解析、工厂模式、反射</p>
<h2 id="IOC过程"><a href="#IOC过程" class="headerlink" title="IOC过程"></a>IOC过程</h2><p><img src="https://img-blog.csdnimg.cn/2021030219074044.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1ODQzNTE0,size_16,color_FFFFFF,t_70" alt="image"></p>
<h2 id="IOC接口"><a href="#IOC接口" class="headerlink" title="IOC接口"></a>IOC接口</h2><ol>
<li>IOC思想基于IOC容器完成，IOC容器底层就是对象工厂</li>
<li>Spring提供IOC容器实现两种方式：（两个接口）<ol>
<li>BeanFactory：IOC容器基本实现，是Spirng内部使用的接口，不提供开发人员进行使用<strong>加载配置文件的时候不会创建，在获取对象(使用)才去创建对象</strong></li>
<li>ApplicationContext：BeanFactory接口的子接口，提供更多更强大的功能，一般是由开发人员进行使用<strong>加载配置文件时候就会在配置文件对象进行创建</strong></li>
</ol>
</li>
<li>ApplicationContext接口其中实现类<br> FileSystemXmlApplicatonContext<br> ClassPathXmlApplicationContext</li>
</ol>
<h2 id="IOC操作Bean管理"><a href="#IOC操作Bean管理" class="headerlink" title="IOC操作Bean管理"></a>IOC操作Bean管理</h2><h3 id="什么是Bean管理"><a href="#什么是Bean管理" class="headerlink" title="什么是Bean管理"></a>什么是Bean管理</h3><ol>
<li>Bean管理指的是两个操作 </li>
<li>Spring创建对象</li>
<li>Spring注入属性</li>
</ol>
<h3 id="Bean管理操作有两种方式"><a href="#Bean管理操作有两种方式" class="headerlink" title="Bean管理操作有两种方式"></a>Bean管理操作有两种方式</h3><ol>
<li>基于XML配置文件方式实现</li>
<li>基于注解方式实现</li>
</ol>
<h4 id="IOC操作Bean管理（基于XML方式）"><a href="#IOC操作Bean管理（基于XML方式）" class="headerlink" title="IOC操作Bean管理（基于XML方式）"></a>IOC操作Bean管理（基于XML方式）</h4><h5 id="基于XML方式创建对象"><a href="#基于XML方式创建对象" class="headerlink" title="基于XML方式创建对象"></a>基于XML方式创建对象</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;&quot; class=&quot;&quot;&gt;&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<ol>
<li>在spring配置文件中，使用bean标签，标签里面添加对应属性，就可以实现对象创建</li>
<li>在bean标签里面有很多属性，常用属性<ol>
<li>id属性：唯一标识</li>
<li>class属性：类全路径（包类路径）</li>
</ol>
</li>
<li><strong>创建对象时候，默认也是执行无参构造方法</strong></li>
</ol>
<h5 id="基于XML方式注入属性"><a href="#基于XML方式注入属性" class="headerlink" title="基于XML方式注入属性"></a>基于XML方式注入属性</h5><p>DI：依赖注入，就是注入属性  </p>
<p><strong>第一种注入方式：使用set方法进行注入</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;book&quot; class=&quot;com.micah.spring.Book&quot;&gt;</span><br><span class="line">  &lt;!--使用Property来进行属性注入--&gt;</span><br><span class="line">    &lt;property name=&quot;bname&quot; value=&quot;上海...研究所&quot;/&gt;</span><br><span class="line">    &lt;property name=&quot;bauthor&quot; value=&quot;Micah&quot;/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<p>可以使用p成名空间进行简化，1 配置引入，2 p:属性名&#x3D;“value”</p>
<p><strong>第二种注入方式：使用有参数构造进行注入</strong> </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--有参构造方法注入属性--&gt;</span><br><span class="line">   &lt;bean id=&quot;orders&quot; class=&quot;com.micah.spring.Orders&quot;&gt;</span><br><span class="line">       &lt;constructor-arg index=&quot;0&quot; value=&quot;haha&quot;/&gt;</span><br><span class="line">       &lt;constructor-arg index=&quot;1&quot; value=&quot;hahhahahahha&quot;/&gt;</span><br><span class="line">       &lt;constructor-arg name=&quot;book&quot; value=&quot;haha&quot;/&gt;</span><br><span class="line">   &lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<h5 id="基于XML注入其他类型属性"><a href="#基于XML注入其他类型属性" class="headerlink" title="基于XML注入其他类型属性"></a>基于XML注入其他类型属性</h5><ol>
<li>字面量  <ol>
<li>null值 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;property name=&quot;bauthor&quot;&gt;</span><br><span class="line">      &lt;null/&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure></li>
<li>属性值包含特殊符号   <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;value&gt;&lt;![CDATA[.....]]&gt;&lt;/value&gt;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li>注入属性-外部bean<ol>
<li>创建两个类service类和dao类  </li>
<li>在service调用dao里面的  </li>
<li>在spring里配置<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;book&quot; class=&quot;com.micah.spring.Book&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;bauthor&quot; ref=&quot;user&quot;/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;bean id=&quot;user&quot;  class=&quot;com.micah.spring.User&quot;&gt; &lt;/bean&gt;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li>注入属性-内部bea<ol>
<li>一对多关系：部门跟员工  </li>
<li>实体类之间表示一对多关系 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;emp&quot; class=&quot;com.micah.spring.emp&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;name&quot; value=&quot;AKAxx&quot;/&gt;</span><br><span class="line">    &lt;!--dept是emp的属性参数--&gt;</span><br><span class="line">    &lt;property name=&quot;dept&quot;&gt;</span><br><span class="line">        &lt;bean id=&quot;dept&quot; class=&quot;com.micah.spring.dept&quot;&gt;</span><br><span class="line">        &lt;/bean&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li>注入属性-级联赋值   <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--第一种写法，外部bean内注入属性--&gt;</span><br><span class="line"></span><br><span class="line">&lt;bean id=&quot;emp&quot; class=&quot;com.micah.spring.emp&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;name&quot; value=&quot;AKAxx&quot;/&gt;</span><br><span class="line">    &lt;!--dept是emp的属性参数--&gt;</span><br><span class="line">    &lt;property name=&quot;dept&quot; ref=&quot;dept&quot;/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line"> &lt;bean id=&quot;dept&quot; class=&quot;com.micah.spring.dept&quot;&gt;</span><br><span class="line">     &lt;property name=&quot;dname&quot; value=&quot;保安部&quot;/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--第二种写法，获取对象后赋值，要有该属性的get方法--&gt;</span><br><span class="line"></span><br><span class="line">&lt;bean id=&quot;emp&quot; class=&quot;com.micah.spring.emp&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;name&quot; value=&quot;AKAxx&quot;/&gt;</span><br><span class="line">    &lt;!--dept是emp的属性参数--&gt;</span><br><span class="line">    &lt;property name=&quot;dept&quot; ref=&quot;dept&quot;/&gt;</span><br><span class="line">    &lt;property name=&quot;dept.dname&quot; value=&quot;技术部&quot;/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line"> &lt;bean id=&quot;dept&quot; class=&quot;com.micah.spring.dept&quot;&gt;</span><br><span class="line">     &lt;property name=&quot;dname&quot; value=&quot;保安部&quot;/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure></li>
<li>XML注入集合属性<br> 注入数组类型属性<br> 注入List集合类型属性<br> 注入Map集合类型属性<br> 在集合里面设置对象类型值<br> 把集合注入部分提取出来   <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;stu&quot; class=&quot;com.micah.spring.stu&quot;&gt;</span><br><span class="line">    &lt;!--数组类型属性注入--&gt;</span><br><span class="line">    &lt;property name=&quot;course&quot;&gt;</span><br><span class="line">        &lt;array&gt;</span><br><span class="line">            &lt;value&gt;英语&lt;/value&gt;</span><br><span class="line">            &lt;value&gt;数学&lt;/value&gt;</span><br><span class="line">        &lt;/array&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;!--List类型属性注入--&gt;</span><br><span class="line">    &lt;property name=&quot;list&quot;&gt;</span><br><span class="line">        &lt;list&gt;</span><br><span class="line">            &lt;value&gt;值1&lt;/value&gt;</span><br><span class="line">            &lt;value&gt;值2&lt;/value&gt;</span><br><span class="line">        &lt;/list&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;!--Map类型属性注入--&gt;</span><br><span class="line">    &lt;property name=&quot;maps&quot;&gt;</span><br><span class="line">        &lt;map&gt;</span><br><span class="line">            &lt;entry key=&quot;JAVA&quot; value =&quot;java&quot;&gt;&lt;/entry&gt;</span><br><span class="line">            &lt;entry key=&quot;PHP&quot; value =&quot;php&quot;&gt;&lt;/entry&gt;</span><br><span class="line">        &lt;/map&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;!--Set类型属性注入--&gt;</span><br><span class="line">    &lt;property name=&quot;sets&quot;&gt;</span><br><span class="line">        &lt;set&gt;</span><br><span class="line">            &lt;value&gt;值1&lt;/value&gt;</span><br><span class="line">            &lt;value&gt;值2&lt;/value&gt;</span><br><span class="line">        &lt;/set&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;!--注入List集合类型，值是对象--&gt;</span><br><span class="line">    &lt;property name=&quot;courseList&quot;&gt;</span><br><span class="line">        &lt;list&gt;</span><br><span class="line">            &lt;ref bean=&quot;course1&quot;&gt;&lt;/ref&gt;</span><br><span class="line">        &lt;/list&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;bean id =&quot;course1&quot; calss.... /&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<strong>把集合注入部分提取出来</strong></li>
</ol>
<ul>
<li>配置中引入名称空间util</li>
<li>使用util标签完成list集合注入提取<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">xmlns:util=&quot;http://www...../schema/util&quot;</span><br><span class="line">xsi:schemaLocation=&quot;.....</span><br><span class="line">            同上bean改为util</span><br><span class="line">            &quot;</span><br><span class="line">&lt;!--提取list集合类型属性注入--&gt;</span><br><span class="line">&lt;util:list id=&quot;bookList&quot;&gt;</span><br><span class="line">    &lt;value&gt;&lt;/value&gt;</span><br><span class="line">    &lt;value&gt;&lt;/value&gt;</span><br><span class="line">    &lt;value&gt;&lt;/value&gt;</span><br><span class="line">&lt;/util:list&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--提取list集合类型属性注入使用--&gt;</span><br><span class="line">&lt;bean id =......&gt;</span><br><span class="line">    &lt;property name =&quot;list&quot; ref=&quot;bookList&quot;/&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="FactoryBean"><a href="#FactoryBean" class="headerlink" title="FactoryBean"></a>FactoryBean</h4><p><strong>spring两种bean：普通bean，工厂bean（FactoryBean）</strong></p>
<p><strong>普通bean：在配置文件中定义bean类型就是返回类型</strong></p>
<p><strong>工厂bean：在配置文件定义bean类型可以和返回类型不一样</strong></p>
<ul>
<li>创建类，让这个类作为工厂bean，实现接口FactoryBean</li>
<li>实现接口里面的方法，在实现的方法中定义返回的bean类型</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public class MyBean implentnts FactoryBean&lt;Course&gt;&#123;</span><br><span class="line">    </span><br><span class="line">    //定义返回bean</span><br><span class="line">    @Override</span><br><span class="line">    public Course getObject() throws Exception&#123;</span><br><span class="line">        Course course = new Course();</span><br><span class="line">        course.setCnam(&quot;abc&quot;);</span><br><span class="line">        return course;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    ....</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="bean作用域"><a href="#bean作用域" class="headerlink" title="bean作用域"></a>bean作用域</h4><p>在spring里面，设置创建bean实例是单实例还是多实例<br>在spring里面，默认情况下，bean是单实例对象。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">    bean标签属性scope控制作用域</span><br><span class="line">    1.singleton 默认值，单实例</span><br><span class="line">    2.prototype 多实例</span><br><span class="line">    3.request </span><br><span class="line">    4.session</span><br><span class="line">--&gt;</span><br><span class="line">&lt;bean id=&quot;book&quot; class=&quot;...&quot; scope=&quot;prototype&quot;&gt;</span><br></pre></td></tr></table></figure>

<h4 id="bean生命周期"><a href="#bean生命周期" class="headerlink" title="bean生命周期"></a>bean生命周期</h4><p><strong>生命周期</strong><br>    从对象创建到对象销毁的过程</p>
<p><strong>bean生命周期</strong><br>1.通过构造器创建bean实例（无参数构造）<br>2.为bean的属性设置值和对其他bean引用（调用set方法）<br>3.调用bean的初始化的方法（需要进行配置初始化的方法）<br>4.bean可以使用了（对象获取到了）<br>5.当容器关闭时候，调用bean的销毁的方法（需要进行配置销毁的方法）  </p>
<p><strong>演示bean生命周期</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id=&quot;&quot; class=&quot;&quot; init-method=&quot;&quot; destroy-method=&quot;&quot; /&gt;</span><br></pre></td></tr></table></figure>

<p><strong>bean的后置处理器，bean生命周期有七步</strong><br>1.通过构造器创建bean实例（无参数构造）<br>2.为bean的属性设置值和对其他bean引用（调用set方法）<br>3.<strong>把bean实例传递给bean前置处理器的方法</strong><br>4.调用bean的初始化的方法（需要进行配置初始化的方法）<br>5.<strong>把bean实例传递给bean后置处理器的方法</strong><br>6.bean可以使用了（对象获取到了）<br>7.当容器关闭时候，调用bean的销毁的方法（需要进行配置销毁的方法）  </p>
<p><strong>添加后置处理器效果</strong><br>1.创建类，实现接口beanPostProcessor</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--配置后置处理器，将会对配置文件中所有bean配置处理器--&gt;</span><br><span class="line">&lt;bean id=&quot;myBeanPost&quot; class=&quot;&quot; /&gt;</span><br></pre></td></tr></table></figure>

<h5 id="XML自动装配"><a href="#XML自动装配" class="headerlink" title="XML自动装配"></a>XML自动装配</h5><p><strong>什么是自动装配</strong><br>根据指定装配规则（属性名称或者属性类型），spring自动将匹配的属性值进行注入。</p>
<p><strong>自动装配过程</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Class Emp&#123;</span><br><span class="line">    Dept dept;</span><br><span class="line">    public void setDept()&#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;!--实现自动装配，baen标签属性autowire，配置自动装配</span><br><span class="line">    autowire属性常用两个值：</span><br><span class="line">    byname根据属性名称注入，注入值bean 的id值和类属性名称一样</span><br><span class="line">    bytype根据属性类型注入，</span><br><span class="line">--&gt;</span><br><span class="line">&lt;bean id=&quot;emp&quot; class=&quot;&quot; autowire=&quot;byName&quot;/&gt;</span><br><span class="line">&lt;bean id=&quot;dept&quot; class=&quot;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--byType问题，如果有两个bean就会出错，比如--&gt;</span><br><span class="line">&lt;bean id=&quot;emp&quot; class=&quot;&quot; autowire=&quot;byType&quot;/&gt;</span><br><span class="line">&lt;bean id=&quot;dept&quot; class=&quot;&quot; /&gt;</span><br><span class="line">&lt;bean id=&quot;dept1&quot; class=&quot;&quot; /&gt;</span><br></pre></td></tr></table></figure>

<h5 id="外部属性文件"><a href="#外部属性文件" class="headerlink" title="外部属性文件"></a>外部属性文件</h5><p><strong>直接配置数据库信息</strong><br>配置德鲁伊连接池<br>引入德鲁伊连接池依赖jar包</p>
<p><strong>引入外部属性文件配置数据库连接池</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--引入外部属性文件--&gt;</span><br><span class="line">&lt;context:property-placeholder location=&quot;classpath:jdbc.properties&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--配置--&gt;</span><br><span class="line">&lt;bean id =&quot;&quot; class=&quot;&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;&quot; value=&quot;$&#123;key&#125;&quot;&gt;</span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>

<h4 id="基于注解方式"><a href="#基于注解方式" class="headerlink" title="基于注解方式"></a>基于注解方式</h4><p><strong>什么是注解</strong>  </p>
<ul>
<li>注解是特殊代码标记，格式：@注解名称（属性名称&#x3D;属性值，…）</li>
<li>使用注解，注解作用在类上面，方法上面，属性上面</li>
<li>使用注解目的：简化xml配置</li>
</ul>
<p><strong>Spring针对Bean管理中创建对象提供注解</strong>  </p>
<ol>
<li>@Component  </li>
<li>@Service  </li>
<li>@Controller  </li>
<li>@Repository<br>上面四个注解功能是一样的，都可以用来创建bean实例</li>
</ol>
<h5 id="基于注解方式实现对象创建"><a href="#基于注解方式实现对象创建" class="headerlink" title="基于注解方式实现对象创建"></a>基于注解方式实现对象创建</h5><p>第一步引入依赖<br>第二步开启组件扫描  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">xmlns:context:&quot;.../context&quot;</span><br><span class="line">xsi:schemalocation=&quot;... </span><br><span class="line">                    ...bean改为context</span><br><span class="line">                    &quot;</span><br><span class="line"></span><br><span class="line">&lt;!--开启组件扫描</span><br><span class="line">    1.如果扫描多个包，多个包使用逗号隔开</span><br><span class="line">    2.扫描包上层目录</span><br><span class="line">--&gt;</span><br><span class="line">&lt;context:component-scan base-package=&quot;com.test&quot; /&gt;</span><br></pre></td></tr></table></figure>
<p>第三步创建类，在类上面添加创建对象注解</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//注解里value属性值可以省略</span><br><span class="line">//默认值是类名称，首字母小写</span><br><span class="line">//Userinfo -- userinfo</span><br><span class="line">@Component(value=&quot;userinfo&quot;) //等价于&lt;bean id=&quot;userinfo&quot; class=&quot;...&quot;/&gt;</span><br><span class="line">public class Userinfo&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="组件扫描细节"><a href="#组件扫描细节" class="headerlink" title="组件扫描细节"></a>组件扫描细节</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--实例1</span><br><span class="line">    use-defaut-filters=&quot;false&quot; 表示现在不适用默认filter，自己配置filter</span><br><span class="line">    context:include-filter ,设置扫描那些内容</span><br><span class="line">--&gt;</span><br><span class="line"></span><br><span class="line">&lt;context:component-scan base-package=&quot;com.test&quot; use-default-filters=&quot;false&quot; &gt;</span><br><span class="line">    &lt;context:include-filter type=&quot;annotation&quot;</span><br><span class="line">            expression=&quot;org.springframework.steretype.Controller&quot;&gt;</span><br><span class="line">&lt;/context:component-scan&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--实例2</span><br><span class="line">    下面配置扫描包所有内容</span><br><span class="line">    context:exclude-filter 设置那些内容不进行扫描</span><br><span class="line">--&gt;</span><br><span class="line">&lt;context:component-scan base-package=&quot;com.test&quot; &gt;</span><br><span class="line">    &lt;context:exclude-filter type=&quot;annotation&quot;</span><br><span class="line">            expression=&quot;org.springframework.steretype.Controller&quot;&gt;</span><br><span class="line">&lt;/context:component-scan&gt;</span><br></pre></td></tr></table></figure>

<h5 id="基于注解方式实现属性注入"><a href="#基于注解方式实现属性注入" class="headerlink" title="基于注解方式实现属性注入"></a>基于注解方式实现属性注入</h5><ul>
<li>@AutoWired：根据属性类型进行自动装配</li>
<li>@Qualifier：根据名称进行注入</li>
<li>@Resource：可以根据类型注入，可以根据名称注入</li>
<li>@Value：注入普通类型属性</li>
</ul>
<h6 id="Autowired：根据属性类型进行自动装配"><a href="#Autowired：根据属性类型进行自动装配" class="headerlink" title="@Autowired：根据属性类型进行自动装配"></a>@Autowired：根据属性类型进行自动装配</h6><ul>
<li>第一步，把server和dao先创建，进行对象注解</li>
<li>第二步，在server添加dao属性，在属性上添加注解</li>
</ul>
<h6 id="Qualifier：根据名称进行注入"><a href="#Qualifier：根据名称进行注入" class="headerlink" title="@Qualifier：根据名称进行注入"></a>@Qualifier：根据名称进行注入</h6><p><strong>要和@AutoWired一起使用</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class userServerImpl&#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    @Qualifier(value=&quot;userDao1&quot;)</span><br><span class="line">    private UserDao userDao;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="Resource：可以根据类型注入，可以根据名称注入"><a href="#Resource：可以根据类型注入，可以根据名称注入" class="headerlink" title="@Resource：可以根据类型注入，可以根据名称注入"></a>@Resource：可以根据类型注入，可以根据名称注入</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class userServerImpl&#123;</span><br><span class="line"></span><br><span class="line">    @Resource(name=&quot;userDao1&quot;)</span><br><span class="line">    private UserDao userDao;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="完全注解开发"><a href="#完全注解开发" class="headerlink" title="完全注解开发"></a>完全注解开发</h5><ol>
<li>创建配置类，替代xml配置</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@Configuration // 作为配置类，替代xml配置文件</span><br><span class="line">@ComponentScan(basePackages=&#123;&quot;com.test&quot;&#125;)</span><br><span class="line">public class SpringConfig&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Test</span><br><span class="line">public void testServe()&#123;</span><br><span class="line">    ApplicationContext context </span><br><span class="line">        = new AnnotataionConfigApplicationContext(SpringConfig.class);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="AOP"><a href="#AOP" class="headerlink" title="AOP"></a>AOP</h1><h2 id="AOP概念"><a href="#AOP概念" class="headerlink" title="AOP概念"></a>AOP概念</h2><p><strong>什么是AOP</strong></p>
<ul>
<li>面向切面编程，利用AOP可以对业务逻辑的各个部分进行隔离，从而使得业务逻辑各部分之间的耦合度降低，提高程序的可重用性，同时提高了开发的效率。</li>
<li>通俗描述：不通过修改源代码方式，在主干功能里面添加新功能</li>
<li>使用登录例子说明AOP</li>
</ul>
<h2 id="AOP底层原理"><a href="#AOP底层原理" class="headerlink" title="AOP底层原理"></a>AOP底层原理</h2><h3 id="AOP底层使用动态代理"><a href="#AOP底层使用动态代理" class="headerlink" title="AOP底层使用动态代理"></a>AOP底层使用动态代理</h3><p>有两种情况动态代理</p>
<p><strong>有接口情况，使用JDK动态代理</strong><br>    创建接口实现类代理对象，增强类的方法</p>
<p><strong>没有接口情况，使用CGLIB动态代理</strong><br>    创建子类的代理对象，增强类的方法</p>
<h2 id="AOP的JDK动态代理"><a href="#AOP的JDK动态代理" class="headerlink" title="AOP的JDK动态代理"></a>AOP的JDK动态代理</h2><p>使用JDK动态代理，使用Proxy类里面的方法创建对象</p>
<ol>
<li>使用newProxyInstan<ol>
<li>第一个参数，类加载器</li>
<li>第二个参数，增强方法所在的类，这个类实现的接口，支持多个接口</li>
<li>第三个参数，实现这个接口InvocationHandler，创建代理对象，写增强的方法</li>
</ol>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Foo f = (Foo) Proxy.newProxyInstance(Foo.class.getClassLoader(), new Class&lt;?&gt;[] &#123; Foo.class &#125;,new MyInvocationHandler());</span><br><span class="line">       f.test();</span><br></pre></td></tr></table></figure>

<h2 id="术语"><a href="#术语" class="headerlink" title="术语"></a>术语</h2><h3 id="连接点"><a href="#连接点" class="headerlink" title="连接点"></a>连接点</h3><p>类里面那些方法可以被增强，这些方法称为连接点</p>
<h3 id="切入点"><a href="#切入点" class="headerlink" title="切入点"></a>切入点</h3><p>实际被真正增强的方法，称为切入点</p>
<h3 id="通知（增强）"><a href="#通知（增强）" class="headerlink" title="通知（增强）"></a>通知（增强）</h3><ol>
<li>实际增强的逻辑部分称为通知  </li>
<li>通知有多种类型<ul>
<li>前置通知</li>
<li>后置通知</li>
<li>环绕通知</li>
<li>异常通知</li>
<li>最终通知</li>
</ul>
</li>
</ol>
<p><strong>注：执行顺序</strong></p>
<ol>
<li>环绕之前。。。</li>
<li>before。。。</li>
<li>方法。。。</li>
<li>环绕之后</li>
<li>after</li>
<li>afterReturing</li>
</ol>
<h3 id="切面"><a href="#切面" class="headerlink" title="切面"></a>切面</h3><p>是动作</p>
<ol>
<li>把通知应用到切入点过程</li>
</ol>
<h2 id="AOP操作准备"><a href="#AOP操作准备" class="headerlink" title="AOP操作准备"></a>AOP操作准备</h2><h3 id="Spring框架一般基于AspectJ实现AOP操作"><a href="#Spring框架一般基于AspectJ实现AOP操作" class="headerlink" title="Spring框架一般基于AspectJ实现AOP操作"></a>Spring框架一般基于AspectJ实现AOP操作</h3><p><strong>什么是AspectJ</strong><br>AspectJ不是Spring组成部分，独立AOP框架，一般把AspectJ和Spring框架一起使用，进行AOP操作</p>
<h3 id="基于AspectJ实现AOP操作"><a href="#基于AspectJ实现AOP操作" class="headerlink" title="基于AspectJ实现AOP操作"></a>基于AspectJ实现AOP操作</h3><ol>
<li>基于XML配置文件</li>
<li>基于注解方式实现（使用）</li>
</ol>
<h3 id="在项目工程里面引入AOP相关依赖"><a href="#在项目工程里面引入AOP相关依赖" class="headerlink" title="在项目工程里面引入AOP相关依赖"></a>在项目工程里面引入AOP相关依赖</h3><h3 id="切入点表达式"><a href="#切入点表达式" class="headerlink" title="切入点表达式"></a>切入点表达式</h3><ol>
<li>切入点表达式作用：知道对哪个类里面的哪个方法增强</li>
<li>语法结构：execution([权限修饰符][返回类型][类全路径][方法名称][([参数列表]))</li>
</ol>
<p>举例1：对com.test.dao.BookDao类里面的add方法进行增强<br>execution(* com.test.dao.BookDao.add(..))</p>
<p>举例2：对com.test.dao.BookDao类里面的所有方法进行增强<br>execution(* com.test.dao.BookDao.*(..))</p>
<p>举例3：对com.test.dao包里面所有类，类里面所有方法进行增强<br>execution(* com.test.dao.<em>.</em>(..))</p>
<h2 id="AOP操作（AspectJ注解）"><a href="#AOP操作（AspectJ注解）" class="headerlink" title="AOP操作（AspectJ注解）"></a>AOP操作（AspectJ注解）</h2><ol>
<li>创建类，在类里面定义方法</li>
<li>创建增强类（编写增加逻辑），在增强类里面，创建方法，让不同方法代表不同通知类型</li>
<li>进行通知的配置<ul>
<li>在spring配置文件中，开启注解扫描</li>
<li>使用注解创建类和增强类对象</li>
<li>在增强类上面添加注解@Aspect</li>
<li>在Spring配置文件中开启生成代理对象</li>
</ul>
</li>
<li>配置不同类型的通知<ul>
<li>在增强类的里面，在作为通知方法上面添加通知类型注解，使用切入点表达式</li>
</ul>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">@Component</span><br><span class="line">@Aspect</span><br><span class="line">public class UserProxy&#123;</span><br><span class="line">    </span><br><span class="line">    // 前置通知</span><br><span class="line">    @Before(value=&quot;execution(* com.test.bean.User.add(..))&quot;)</span><br><span class="line">    public void before()&#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 后置通知（返回通知）,返回结果后执行，有异常不执行</span><br><span class="line">    @AfterReturning(value=&quot;execution(* com.test.bean.User.add(..))&quot;)</span><br><span class="line">    public void afterReturning()&#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //最终通知，执行方法后执行，有异常也执行</span><br><span class="line">    @After(value=&quot;execution(* com.test.bean.User.add(..))&quot;)</span><br><span class="line">    </span><br><span class="line">    // 异常通知</span><br><span class="line">    //AfterThrowing(value=&quot;execution(* com.test.bean.User.add(..))&quot;)</span><br><span class="line">    </span><br><span class="line">    // 环绕通知</span><br><span class="line">    @Around(value=&quot;execution(* com.test.bean.User.add(..))&quot;)</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>相同的切入点进行抽取</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 相同切入点抽取</span><br><span class="line">@Pointcut(value=&quot;execution(* com.test.bean.User.add(..))&quot;)</span><br><span class="line">public void pointdemo()&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 使用相同切入点方法示例</span><br><span class="line">@Before(value=&quot;pointdemo()&quot;)</span><br><span class="line">public void before()&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>有多个增强类同一个方法进行增强，设置增强类的优先级<ul>
<li>在增强类上面添加注解@Order（数字类型值），数字类型值越小优先级越高</li>
</ul>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Component</span><br><span class="line">@Aspect</span><br><span class="line">@Order(1) </span><br><span class="line">public class PersonProxy&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h1 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h1><h2 id="什么是事务"><a href="#什么是事务" class="headerlink" title="什么是事务"></a>什么是事务</h2><ol>
<li>事务是数据库操作最基本单元，逻辑上一组操作，要么都成功，如果说如果一个失败所有操作都失败。</li>
<li>典型场景：银行转账</li>
</ol>
<h2 id="事务四个特性（ACID-）"><a href="#事务四个特性（ACID-）" class="headerlink" title="事务四个特性（ACID ）"></a>事务四个特性（ACID ）</h2><ul>
<li>原子性</li>
<li>一致性</li>
<li>隔离性</li>
<li>持久性</li>
</ul>
<h2 id="事务操作过程"><a href="#事务操作过程" class="headerlink" title="事务操作过程"></a>事务操作过程</h2><ol>
<li>开启事务</li>
<li>进行业务操作</li>
<li>没有发生异常，提交事务</li>
<li>出现异常，事务回滚</li>
</ol>
<h2 id="事务操作"><a href="#事务操作" class="headerlink" title="事务操作"></a>事务操作</h2><h3 id="Sppring事务管理介绍"><a href="#Sppring事务管理介绍" class="headerlink" title="Sppring事务管理介绍"></a>Sppring事务管理介绍</h3><ol>
<li>事务添加到JvaEE三层结构里面Service层（业务逻辑层）</li>
<li>在Spring进行事务管理操作<ul>
<li>有两种方式：编程式事务管理和声明式事务管理（使用）</li>
</ul>
</li>
<li>声明式事务管理<ul>
<li>基于注解方式</li>
<li>基于XML配置文件方式</li>
</ul>
</li>
<li>在Spring进行声明式事务管理，底层使用AOP</li>
<li>Spring事务管理API<ol>
<li>提供一个接口，代表事务管理器，这个接口针对不同的框架提供不同的实现类（PlatformTransactionManager）</li>
</ol>
</li>
</ol>
<h3 id="注解声明式事务管理"><a href="#注解声明式事务管理" class="headerlink" title="注解声明式事务管理"></a>注解声明式事务管理</h3><ol>
<li>在spring配置文件中配置事务管理器</li>
<li>在spring配置文件，开启事务注解<ul>
<li>在spring配置文件引入名称空间tx</li>
<li>开启事务注解</li>
</ul>
</li>
<li>在service类上面（或者service类里面方法上面）添加事务注解<ul>
<li>@Transactional,这个注解添加到类上面，也可以添加到方法上面</li>
<li>如果把这个注解添加类上面，这个类里面所有的方法都添加事务</li>
<li>如果把这个注解添加方法上面，为这个方法添加事务</li>
</ul>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--创建事务管理器--&gt;</span><br><span class="line">&lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;</span><br><span class="line">    &lt;!--注入数据源--&gt;</span><br><span class="line">    &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt; </span><br><span class="line">&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--开启事务注解--&gt;</span><br><span class="line">&lt;tx:annotation-driven transaction-manager=&quot;transactionManager&quot;/&gt;</span><br></pre></td></tr></table></figure>

<h3 id="声明式事务管理参数配置"><a href="#声明式事务管理参数配置" class="headerlink" title="声明式事务管理参数配置"></a>声明式事务管理参数配置</h3><p><strong>在service类上面添加注解@Transactional，在这个注解里面可以配置事务相关参数</strong></p>
<h4 id="propagation：事务传播行为"><a href="#propagation：事务传播行为" class="headerlink" title="propagation：事务传播行为"></a>propagation：事务传播行为</h4><ol>
<li>多事务方法之间进行调用，这个过程中事务是如何进行管理的</li>
<li>spring中定义了7中类传播行为</li>
</ol>
<h5 id="REQUIRED（默认值）"><a href="#REQUIRED（默认值）" class="headerlink" title="REQUIRED（默认值）"></a>REQUIRED（默认值）</h5><p>如果有事务在运行，当前的方法就在这个事务内运行，否则，就启动一个新的事务，并在自己的事务内运行</p>
<h5 id="REQUIRED-NEW"><a href="#REQUIRED-NEW" class="headerlink" title="REQUIRED_NEW"></a>REQUIRED_NEW</h5><p>当前的方法必须启动新事务，并在自己的事务内运行，如果有事务正在运行，应该将它挂起</p>
<p><img src="https://img-blog.csdnimg.cn/20210306191809640.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1ODQzNTE0,size_16,color_FFFFFF,t_70" alt="image"></p>
<h4 id="iosalton：事务隔离级别"><a href="#iosalton：事务隔离级别" class="headerlink" title="iosalton：事务隔离级别"></a>iosalton：事务隔离级别</h4><ol>
<li>事务有特性称为隔离性，多事务操作之间不会产生影响。不考虑隔离性产生很多问题。  </li>
<li>有三个读问题：脏读，不可重复读，虚读</li>
<li>通过设置事务隔离级别，解决读的问题</li>
<li>一共4个隔离级别</li>
</ol>
<p><img src="https://img-blog.csdnimg.cn/20210306191909673.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1ODQzNTE0,size_16,color_FFFFFF,t_70" alt="image"></p>
<h4 id="timeout：超时时间"><a href="#timeout：超时时间" class="headerlink" title="timeout：超时时间"></a>timeout：超时时间</h4><ol>
<li>事务需要在一定时间内进行提交，如果不提交进行回滚</li>
<li>默认值是-1，设置时间以秒单位进行计算</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Service</span><br><span class="line">@Transactional(timeout = -1,propagation = Propagation.REQUIRED, isolation=Isolation.REPEATABLE_READ)</span><br><span class="line">public Class UserService()&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="readOnly：是否只读"><a href="#readOnly：是否只读" class="headerlink" title="readOnly：是否只读"></a>readOnly：是否只读</h4><ol>
<li>读：查询操作，写：添加修改删除操作</li>
<li>readOnly默认值：false,表示可以查询，可以添加修改删除操作</li>
<li>设置readOnly值是true，设置成true之后，只能查询<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Service</span><br><span class="line">@Transactional(timeout = -1,propagation = Propagation.REQUIRED, isolation=Isolation.REPEATABLE_READ)</span><br><span class="line">public Class UserService()&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="rollbackFor：回滚"><a href="#rollbackFor：回滚" class="headerlink" title="rollbackFor：回滚"></a>rollbackFor：回滚</h4><ol>
<li>设置出现哪些异常进行事务回滚</li>
</ol>
<h4 id="noRollbackFor：不回滚"><a href="#noRollbackFor：不回滚" class="headerlink" title="noRollbackFor：不回滚"></a>noRollbackFor：不回滚</h4><ol>
<li>设置出现哪些异常不进行事务回滚</li>
</ol>
<h3 id="XML声明式事务管理（了解）"><a href="#XML声明式事务管理（了解）" class="headerlink" title="XML声明式事务管理（了解）"></a>XML声明式事务管理（了解）</h3><ol>
<li>配置事务管理器</li>
<li>配置通知</li>
<li>配置切入点和切面</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--创建事务管理器--&gt;</span><br><span class="line">&lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;</span><br><span class="line">    &lt;!--注入数据源--&gt;</span><br><span class="line">    &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt; </span><br><span class="line">&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--配置通知--&gt;</span><br><span class="line">&lt;tx:advice id=&quot;txadvice&quot;&gt;</span><br><span class="line">    &lt;!--配置事务参数--&gt;</span><br><span class="line">    &lt;tx:attributes&gt;</span><br><span class="line">        &lt;!--指定哪种规则的方法上面添加事务--&gt;</span><br><span class="line">        &lt;tx:method name=&quot;accountMoney&quot; propagation=&quot;REQUIRED&quot;/&gt;</span><br><span class="line">        &lt;!--&lt;tx:method name=&quot;account*&quot;/&gt;--&gt;</span><br><span class="line">    &lt;/tx:attributes&gt;</span><br><span class="line">&lt;/tx:advice&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--配置切入点和切面--&gt;</span><br><span class="line">&lt;aop:config&gt;</span><br><span class="line">    &lt;!--配置切入点--&gt;</span><br><span class="line">    &lt;aop:pointcunt id =&quot;pt&quot; expression=&quot;execution(* com.test.service.UserService.*(..))&quot;&gt;</span><br><span class="line">    &lt;!--配置切面--&gt;</span><br><span class="line">    &lt;aop:advice advice-ref=&quot;txadvice&quot; pointcut-ref=&quot;pt&quot;&gt;</span><br><span class="line">&lt;/aop:config&gt;</span><br></pre></td></tr></table></figure>

<h3 id="完全注解声明式事务管理"><a href="#完全注解声明式事务管理" class="headerlink" title="完全注解声明式事务管理"></a>完全注解声明式事务管理</h3><ol>
<li>创建配置类，使用配置类代理xml配置</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">@Configuration // 配置类</span><br><span class="line">@ComponentScan(basePackages = &quot;com.test&quot;) // 组件扫描</span><br><span class="line">@EnableTransactionManagerment // 开启事务</span><br><span class="line">public class TxConfg&#123;</span><br><span class="line"></span><br><span class="line">    // 创建数据连接池</span><br><span class="line">    @Bean</span><br><span class="line">    public DruidDataSource getDuridDataSource()&#123;</span><br><span class="line">        DruidDataSource dataSource = new DruidDataSource();</span><br><span class="line">        dataSource.setDriverClassName(&quot;&quot;);</span><br><span class="line">        dataSource.setUrl(&quot;&quot;);</span><br><span class="line">        dataSource.setUsername(&quot;&quot;);</span><br><span class="line">        dataSource.setPassword(&quot;&quot;);</span><br><span class="line">        return dataSource;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 创建JdbcTemplacte对象</span><br><span class="line">    @Bean</span><br><span class="line">    public JdbcTemplate getJdbcTemplate(DataSource dataSource)&#123;</span><br><span class="line">        // 到IOC容器中根据类型找到dataSource</span><br><span class="line">      JdbcTemplate jdbcTemplate = new JdbcTemplate();</span><br><span class="line">      // 注入dataSource</span><br><span class="line">      jdbcTemplate.setDataSource();</span><br><span class="line">      return jdbcTemplate;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 创建事务管理器</span><br><span class="line">     @Bean</span><br><span class="line">     public DataSourceTransaction getDataSourceTransaction(DataSource dataSource)&#123;</span><br><span class="line">         DataSourceTransaction transactionManager = new DataSourceTransaction();</span><br><span class="line">         transactionManager.setDataSource();</span><br><span class="line">         return transactionManager;</span><br><span class="line">     &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="问题："><a href="#问题：" class="headerlink" title="问题："></a>问题：</h1><p><strong>Q:为什么要使用代理而不用继承？</strong><br><strong>A:</strong> 继承增加了关联性，同时只能对一个方法进行强化，代理可以降低耦合度。  </p>
<p><strong>Q:能否对一个类同时使用多个代理？如果可以，执行顺序？</strong><br><strong>A:</strong> 可以，order参数设置优先级，默认最低优先级。  </p>
<p><strong>Q:怎么理解readonly&#x3D;true？</strong><br><strong>A:</strong> </p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Java/" rel="tag"><i class="fa fa-tag"></i> Java</a>
              <a href="/tags/Spring/" rel="tag"><i class="fa fa-tag"></i> Spring</a>
              <a href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag"><i class="fa fa-tag"></i> 笔记</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/11/19/%E3%80%8A%E6%94%BE%E5%AD%A6%E5%90%8E%E3%80%8B%E4%B9%A6%E8%AF%84/" rel="prev" title="《放学后》书评">
                  <i class="fa fa-angle-left"></i> 《放学后》书评
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2021/12/09/JAVA%E7%9A%84PBE%E5%8A%A0%E5%AF%86/" rel="next" title="JAVA的PBE加密">
                  JAVA的PBE加密 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2019 – 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Yellow</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">122k</span>
  </span>
</div>

    </div>
  </footer>

    
​
  <script color="0, 0, 255" 
          opacity="0.5" 
          zIndex="-1" 
          count="120" 
          src="https://cdn.jsdelivr.net/npm/canvas-nest.js@1/dist/canvas-nest.js">
  </script>
​
  

  

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  






  




 

<script>
  var OriginTitile = document.title;
  var titleTime;
  //换网站的logo
  function selfSetIcon(url){
        var links = document.getElementsByTagName('link') 
        for (var i = 0; i < links.length; i++) { 
            var link = links[i]
            var rel = link.rel; 
            var count = 0;
            rel = rel.toLowerCase(); 
            if (rel.indexOf('icon') == 0) { 
                count++;
                link.href = url;
                if(count == 2)
                    break;
            }
        }
    }
  
  document.addEventListener("visibilitychange", function() {
    if (document.hidden) {
      document.title = "(●—●)喔噢，崩溃了~|" + OriginTitile;
      // selfSetIcon("");
      clearTimeout(titleTime);
    } else {
      // selfSetIcon("/images/favicon-32x32-next.png");
      document.title = "φ(>ω<*) 咦！又好了！|" + OriginTitile;
      titleTime = setTimeout(function() {
        document.title = OriginTitile;
        
      }, 2000);
    }
  });
  
</script>

</body>
</html>
<script type="text/javascript" src="/js/src/click.js"></script>